---
title: "proj"
author: "oysik saif"
date: "2024-06-12"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=FALSE, warning=FALSE, message=FALSE)
library(tidyverse)
library(sf)
library(tmap)
library(rnaturalearth)
library(rnaturalearthhires)
library(rnaturalearthdata)
setwd('/Users/oysik10/Desktop/oysik_datalab/datalab_2024/proj')
sewanee_weather<-read_csv('sewanee_weather.csv')
```

# Introduction

Here are what we will be covering: 

- Minimum and Maximum Temperature over time. 
- What month has the most snowfall on average?
- Effect of temperature in precipitation.

## Effect of Temperature in Precipitation

```{r}

sewanee_weather<-sewanee_weather %>% 
  mutate(avg_t=(TMAX+TMIN)/2) %>% 
  mutate(year = as.integer(format(DATE, "%Y")))

ggplot(data=sewanee_weather %>%  filter(year>=2010 & year<=2020), aes(x=avg_t, y= PRCP))+
  geom_line(aes(color = factor(year)))
  labs(title='Relation between Temperature and Precipitation from 2010 to 2020',
       color='YEAR',
       x='AVG TEMPERATURE',
       y='PRECIPITATION')+
    theme_minimal()
```
## Effect of Temperature in Precipitation
```{r}

sewanee_weather<-sewanee_weather %>% 
  mutate(avg_t=(TMAX+TMIN)/2) %>% 
  mutate(year = year(DATE))

ggplot(data=sewanee_weather %>%  filter(year>=2010 & year<=2020), aes(x=avg_t, y= PRCP))+
  geom_line(aes(color = year))
  labs(title='Relation between Temperature and Precipitation from 2010 to 2020',
       color='YEAR',
       x='AVG TEMPERATURE',
       y='PRECIPITATION')+
    theme_minimal()
```

## Average Precipitation for each month over five year periods

```{r}
updated<- sewanee_weather %>%
  filter(year>=2000 & year<=2025) %>% 
  mutate(year = year(DATE),
         month = month(DATE)) %>%
  mutate(period = cut(year, breaks = seq(2000, 2025, by = 5))) %>%
  group_by(period, month) %>%
  summarize(mean_prcp = mean(PRCP, na.rm = TRUE))

updated<-na.omit(updated)
  
ggplot(data=updated, aes(x=month, y=mean_prcp, col=month))+
  geom_line()+
  facet_wrap(~period)
```
